- PolicySet:
    hosts:
    - localhost
    name: Check for mysql package installation
    policies:
    - Policy:
        actions:
        - Action:
            action: deny
            action_args:
              msg: The package {{ input.task.module }} is not allowed, allowed packages
                are one of {{ allowed_packages.join(", ") }}
        condition:
          AllCondition:
          - ItemNotInListExpression:
              lhs:
                String: input.task.module
              rhs:
                String: allowed_packages
        enabled: true
        name: Check for package name
        tags:
        - compliance
    vars:
      allowed_packages:
      - mysql
