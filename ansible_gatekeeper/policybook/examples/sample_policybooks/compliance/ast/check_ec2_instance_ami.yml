- PolicySet:
    hosts:
    - localhost
    name: Restrict instances with unapproved AMIs
    policies:
    - Policy:
        actions:
        - Action:
            action: deny
            action_args:
              msg: The image {{ input["amazon.aws.rds_instance"].image_id}} is not
                allowed, allowed images are one of {{ allowed_image_ids }}
        condition:
          AllCondition:
          - ItemNotInListExpression:
              lhs:
                String: input["amazon.aws.rds_instance"].image_id
              rhs:
                String: allowed_image_ids
        enabled: true
        name: Restrict instances with unapproved AMIs
        tags:
        - compliance
        target: task
    vars:
      allowed_image_ids:
      - ami-123456
      - ami-789011
